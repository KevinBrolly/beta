{% extends "account/admin_base.html" %}

{% block content %}
<div class="row">
    <div class="columns">
        <div class="copy-container">
            <h4>Problem Reports</h4>
            <ul class="problem-reports edit">
                {% for report in object_list %}
                    <li>
                        <div class="heading">
                            <h3>Problem reported with <a href="{% url 'service_detail' pk=report.service.pk %}">{{ report.service }}</a></h3>
                        </div>
                        <p>{{ report.message }}</p>
                        <p>Reported by <a href="mailto:{{ report.email }}">{{ report.email }}</a> on {{ report.created_on }}</p>
                        {% if report.status == report.UNRESOLVED %}
                            <div class="edit-options">
                                <a href="{% url 'service_edit' pk=report.service.pk %}" class="icon-link">
                                    <span class="icon">
                                        <i class="fas fa-pencil-alt"></i>
                                    </span>
                                    Edit Service
                                </a>
                                <form method="post" action="{% url 'service_problem_update' pk=report.pk %}">
                                    {% csrf_token %}
                                    <input type="hidden" name="status" value="{{ report.RESOLVED }}" />
                                    <button type="submit" class="txt-button secondary icon-link">
                                        <span class="icon">
                                            <i class="fas fa-check"></i>
                                        </span>
                                        Mark as Resolved
                                    </button>
                                </form>
                            </div>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
            {% include 'partials/pagination.html' with page=page_obj paginator=paginator %}
        </div>
    </div>
</div>
{% endblock %}
