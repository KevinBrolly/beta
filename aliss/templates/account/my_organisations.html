{% extends "account/base.html" %}

{% block content %}
  <div class="row">
  <div class="columns">
    <h4>My Organisations</h4>
    <p><a href="{% url 'organisation_search' %}">Add or edit another organisation</a></p>
    <table class="stack">
      <thead>
        <tr>
          <th width="">Name</th>
          <th width="">No. of services</th>
          <th width="">Last updated</th>
          <th width="">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% if object_list or orgs_list %}
        {% for claim in object_list %}
        <tr>
          <td>
            <a href="{% url 'organisation_detail' pk=claim.organisation.pk %}">{{ claim.organisation.name }}
            </a>
          </td>
          <td>
            {% if claim.organisation.services.count > 0 %}
              {{ claim.organisation.services.count }}
            {% else %}
              <span style="color:red;">{{ claim.organisation.services.count }}
                <span data-tooltip aria-haspopup="true" class="has-tip right" data-disable-hover="false" tabindex="2" title="Until you add services that belong to the organisation it won't be published on ALISS.">
                <i class="fa fa-question-circle" aria-hidden="true"></i>
              </span></span>
            {% endif %}
          </td>
          <td>{{ claim.organisation.updated_on }}</td>
          <td>
            <a href="{% url 'organisation_edit' pk=claim.organisation.pk %}">
              <i class="fa fa-edit" aria-hidden="true"></i> Edit
            </a>
            <a href="{% url 'claim_delete' pk=claim.pk %}" class="alert">
              <i class="fas fa-minus-hexagon"></i> Stop representing
            </a>
          </td>
        </tr>
        {% endfor %}

        {% for organisation in orgs_list %}
        <tr>
          <td>
            <a href="{% url 'organisation_detail' pk=organisation.pk %}">
            {{ organisation.name }}</a>
          </td>
          <td>
            {% if organisation.services.count > 0 %}
              {{ organisation.services.count }}
            {% else %}
              <span class="alert">{{ organisation.services.count }}
                <span data-tooltip aria-haspopup="true" class="has-tip right" data-disable-hover="false" tabindex="2" title="Until you add services that belong to the organisation it won't be published on ALISS.">
                <i class="fa fa-question-circle" aria-hidden="true"></i>
              </span></span>
            {% endif %}
          </td>
          <td>{{ organisation.updated_on }}</td>
          <td>
            <a href="{% url 'organisation_edit' pk=organisation.pk %}">
              <i class="fa fa-edit" aria-hidden="true"></i> Edit
            </a>
          </td>
        </tr>
        {% endfor %}
        {% else %}
          <tr><td colspan="4">
            <p class="center">
                You are not currently representing any organisations<br/>
                <a href="{% url 'organisation_search' %}">Add an organisation</a>
            </p>
          </td></tr>
        {% endif %}
      </tbody>
    </table>
  </div>
  </div>
{% endblock %}