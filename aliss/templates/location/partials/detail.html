{% load aliss %}

<div class="location">
  <a style="display:inline-block;" href="https://maps.google.com?daddr={{ location.formatted_address }}" class="icon-link">
    <span class="icon">
      <i aria-hidden="true" class="fas fa-map-marker-alt"></i>
    </span>
    {{ location.formatted_address }}
  </a>
  <br/>
  {% for ap in location.assigned_properties.all %}
    <span data-tooltip aria-haspopup="true" class="property has-tip right" data-disable-hover="false" tabindex="2" title="{{ ap.name }}: {{ ap.property_definition.description }}" title="{{ ap.name }}">{{ ap.property_definition.icon_html }}</span>
  {% endfor %}

  {% can_edit request.user location as user_can_edit %}
  {% if user_can_edit %}
    <div class="edit-options">
      <a href="{% url 'location_edit' pk=location.pk %}" class="icon-link">
        <span class="icon">
          <i aria-hidden="true" class="fas fa-pencil-alt"></i>
        </span>
        Edit location
      </a>
      {% get_service_at_location_slug object.pk location.pk as service_at_location_slug %}
      <p>{{service_at_location_pk}}</p>
      <form method='post' action="{% url 'service_at_location_delete' service_at_location_pk=service_at_location_slug%}">
        {% csrf_token %}
        <button type="submit" class="txt-button alert icon-link" style="margin-top: 0rem;">
          <span class="icon">
            <i class="fas fa-trash-alt"></i>
          </span>
          Remove location
        </button>
      </form>
    </div>
  {% endif %}
</div>